<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ShopLite | Home</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Fonts (fixed) -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Roboto&family=Montserrat:wght@500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Roboto', sans-serif; }
    h1, h2, h3, .nav-link { font-family: 'Poppins', sans-serif; }
    .btn, .price { font-family: 'Montserrat', sans-serif; }
    
    /* Custom styles for enhanced UI */
    .product-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .product-card:hover {
      transform: translateY(-5px);
    }
    .category-btn {
      transition: all 0.3s ease;
    }
    .line-clamp-1 {
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .cart-pulse {
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body class="bg-[#fcfcfc] text-[#1a1b41]">

  <!-- Navbar -->
  <header class="bg-[#1a1b41] text-white sticky top-0 z-50">
    <div class="container mx-auto flex items-center justify-between p-4">
      <!-- Logo -->
      <a href="index.html" class="text-3xl font-bold">
        <span class="text-[#baff29]">Shop</span>Lite
      </a>

      <!-- Nav Links (Desktop) -->
      <nav id="nav-links" class="hidden md:flex gap-6">
        <a href="index.html" class="nav-link hover:text-[#baff29]">Home</a>
        <a href="orders.html" class="nav-link hover:text-[#baff29]">Shop</a>
        <a href="/Pages/About.html" class="nav-link hover:text-[#baff29]">About</a>
        <a href="./Pages/contact.html" class="nav-link hover:text-[#baff29]">Contact</a>
      </nav>

        
        <!-- Cart -->
        <a href="cart.html" class="relative">
          ðŸ›’
          <span id="cart-count" class="absolute -top-2 -right-3 bg-[#3bc14a] text-white text-xs rounded-full px-2">0</span>
        </a>

        <!-- Mobile Menu Button -->
        <button id="menu-btn" class="md:hidden text-2xl">â˜°</button>
      </div>
    </div>

    <!-- Mobile Nav -->
    <div id="mobile-menu" class="hidden bg-[#1a1b41] p-4 md:hidden">
      <a href="index.html" class="block py-2 hover:text-[#baff29]">Home</a>
      <a href="orders.html" class="block py-2 hover:text-[#baff29]">Orders</a>
      <a href="/Pages/About.html" class="block py-2 hover:text-[#baff29]">About</a>
      <a href="/Pages/contact.html" class="block py-2 hover:text-[#baff29]">Contact</a>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="relative w-full h-[70vh] overflow-hidden">
    <!-- Slides -->
    <div id="hero-bg" class="absolute inset-0 flex transition-transform duration-700 ease-in-out">
      <img src="https://images.unsplash.com/photo-1550009158-9ebf69173e03?q=80&w=1201&auto=format&fit=crop&ixlib=rb-4.1.0" class="w-full h-full object-cover flex-shrink-0" alt="Electronics">
      <img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0" class="w-full h-full object-cover flex-shrink-0" alt="Electronics">
      <img src="https://images.unsplash.com/photo-1526170375885-4d8ecf77b99f?auto=format&fit=crop&w=1600&q=80" class="w-full h-full object-cover flex-shrink-0" alt="Shopping">
    </div>

    <!-- Overlay -->
    <div class="absolute inset-0 bg-black/50"></div>

    <!-- Text Content -->
    <div class="relative z-10 flex flex-col items-center justify-center h-full text-center text-white px-6">
      <div class="bg-[#1a1b41]/70 p-6 md:p-10 rounded-lg shadow-lg">
        <h1 class="text-4xl md:text-6xl font-bold mb-4">
          Fresh <span class="text-[#baff29]">Deals</span>, Just for You
        </h1>
        <p class="text-lg mb-6 text-gray-200">
          Discover the latest products at unbeatable prices. Fast shipping, secure checkout, and daily offers.
        </p>
        <a href="#products" class="bg-[#3bc14a] text-white px-8 py-3 rounded-lg shadow hover:bg-green-700 transition">
          Shop Now
        </a>
      </div>
    </div>

    <!-- Promo Marquee -->
    <marquee class="absolute bottom-0 left-0 w-full bg-[#baff29] text-[#1a1b41] font-bold py-2">
      ðŸš€ Big Sale Today! Â· ðŸ›’ Free Shipping on Orders Over $50 Â· ðŸ”¥ Up to 60% Off Selected Items Â· ðŸŽ‰ ShopLite Exclusive Deals
    </marquee>
  </section>

  <!-- Featured Products -->
  <section id="products" class="py-12 px-6 container mx-auto">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-bold">Featured Products</h2>
      <button id="all-products-btn" class="btn bg-[#1a1b41] text-white px-4 py-2 rounded hover:bg-[#3a3b7a] transition">
        View All Products
      </button>
    </div>
    <div id="loading-products" class="text-center py-8">
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-[#3bc14a]"></div>
      <p class="mt-2 text-gray-600">Loading products...</p>
    </div>
    <div id="product-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
  </section>

  <!-- Categories -->
  <section class="bg-[#f9f9f9] py-12 px-6">
    <div class="container mx-auto">
      <h2 class="text-2xl font-bold mb-6">Shop by Category</h2>
      <div id="loading-categories" class="text-center py-4">
        <div class="inline-block animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-[#3bc14a]"></div>
        <p class="mt-2 text-gray-600">Loading categories...</p>
      </div>
      <div id="categories" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6"></div>
    </div>
  </section>

  <!-- Toast Notification -->
  <div id="toast" class="fixed bottom-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg transform translate-y-20 transition-transform duration-300">
    Product added to cart!
  </div>

  <!-- Footer -->
  <footer class="bg-[#1a1b41] text-white py-6 text-center">
    <p>&copy; 2025 ShopLite. All rights reserved.</p>
  </footer>

  <!-- JS -->
  <script>
    // API endpoints
    const API_URL = "https://api.escuelajs.co/api/v1/products";
    const CAT_URL = "https://api.escuelajs.co/api/v1/categories";

    // DOM elements
    const productList = document.getElementById("product-list");
    const categoriesDiv = document.getElementById("categories");
    const cartCount = document.getElementById("cart-count");
    const menuBtn = document.getElementById("menu-btn");
    const mobileMenu = document.getElementById("mobile-menu");
    const allProductsBtn = document.getElementById("all-products-btn");
    const loadingProducts = document.getElementById("loading-products");
    const loadingCategories = document.getElementById("loading-categories");
    const toast = document.getElementById("toast");

    // Hero Section auto slider
    const heroBg = document.getElementById("hero-bg");
    let index = 0;
    const slidesCount = heroBg.children.length;

    function showSlide(i) {
      index = (i + slidesCount) % slidesCount; 
      heroBg.style.transform = `translateX(-${index * 100}%)`;
    }

    // Auto Slide
    setInterval(() => {
      showSlide(index + 1);
    }, 4000);

    // Utility: pick the first valid image URL
    function getValidImage(images) {
      if (Array.isArray(images)) {
        for (let img of images) {
          if (img && typeof img === "string" && img.startsWith("http") && !img.includes("localhost")) {
            return img;
          }
        }
      }
      return "https://placehold.co/300x200?text=No+Image";
    }

    // Fetch products
    async function fetchProducts(categoryId = null) {
      try {
        loadingProducts.classList.remove("hidden");
        productList.innerHTML = '';
        
        let url = categoryId
          ? `${CAT_URL}/${categoryId}/products`
          : `${API_URL}?offset=0&limit=8`;

        const res = await fetch(url);
        const products = await res.json();

        if (!Array.isArray(products)) {
          loadingProducts.classList.add("hidden");
          productList.innerHTML = '<p class="text-center col-span-full text-red-500">Error loading products. Please try again.</p>';
          return;
        }

        renderProducts(products);
        loadingProducts.classList.add("hidden");
      } catch (err) {
        loadingProducts.classList.add("hidden");
        productList.innerHTML = '<p class="text-center col-span-full text-red-500">Error loading products. Please try again.</p>';
      }
    }

    // Render products
    function renderProducts(products) {
      productList.innerHTML = products.map((p) => {
        const imgSrc = getValidImage(p.images);
        return `
          <div class="product-card bg-white rounded-lg shadow-md overflow-hidden">
            <img src="${imgSrc}" alt="${p.title}" class="h-48 w-full object-contain p-4">
            <div class="p-4">
              <h3 class="font-semibold text-gray-800 line-clamp-1">${p.title}</h3>
              <p class="text-gray-600 text-sm mt-1 line-clamp-2">${p.description || 'No description available'}</p>
              <p class="price text-[#1a1b41] font-bold mt-2">$${p.price}</p>
              
              <button onclick="addToCart(${p.id}, '${p.title.replace(/'/g, "\\'")}', ${p.price}, '${imgSrc}')"
                class="mt-3 w-full bg-[#3bc14a] text-white py-2 rounded hover:bg-green-700 transition">
                Add to Cart
              </button>
              <a href="product.html?id=${p.id}" class="mt-3 block text-center text-[#1a1b41] hover:text-[#3bc14a] font-semibold transition">
                View Details
              </a>
            </div>
          </div>`;
      }).join("");
    }

    // Fetch categories
    async function fetchCategories() {
      try {
        loadingCategories.classList.remove("hidden");
        categoriesDiv.innerHTML = '';
        
        const res = await fetch(CAT_URL);
        const categories = await res.json();

        if (!Array.isArray(categories)) {
          loadingCategories.classList.add("hidden");
          categoriesDiv.innerHTML = '<p class="text-center col-span-full text-red-500">Error loading categories.</p>';
          return;
        }

        renderCategories(categories);
        loadingCategories.classList.add("hidden");
      } catch (err) {
        loadingCategories.classList.add("hidden");
        categoriesDiv.innerHTML = '<p class="text-center col-span-full text-red-500">Error loading categories.</p>';
      }
    }

    // Render categories
    function renderCategories(categories) {
      const limitedCategories = categories.slice(0, 4);
      categoriesDiv.innerHTML = limitedCategories.map((cat) => `
        <button onclick="fetchProducts(${cat.id})"
          class="category-btn px-6 py-8 bg-[#1a1b41] text-white rounded-lg hover:bg-[#3bc14a] transition text-lg font-semibold">
          ${cat.name}
        </button>`).join("");
    }

    // Show toast notification
    function showToast() {
      toast.classList.remove("translate-y-20");
      setTimeout(() => {
        toast.classList.add("translate-y-20");
      }, 2000);
    }

    // Add product to cart (localStorage)
    function addToCart(productId, title, price, image) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      const idx = cart.findIndex((i) => i.id === productId);

      if (idx >= 0) {
        cart[idx].qty++;
      } else {
        cart.push({ id: productId, qty: 1, title, price, image });
      }

      localStorage.setItem("cart", JSON.stringify(cart));
      updateCartCount();
      showToast();

      cartCount.classList.add("cart-pulse");
      setTimeout(() => cartCount.classList.remove("cart-pulse"), 1500);
    }

    // Update cart icon count
    function updateCartCount() {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      const totalItems = cart.reduce((sum, i) => sum + i.qty, 0);
      cartCount.textContent = totalItems;
      if (totalItems > 0) cartCount.classList.remove("hidden");
      else cartCount.classList.add("hidden");
    }

    // Mobile menu toggle
    menuBtn.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
    });

    // View all products button
    allProductsBtn.addEventListener("click", () => {
      fetchProducts();
    });

    // Initialize page
    document.addEventListener("DOMContentLoaded", function() {
      fetchProducts();
      fetchCategories();
      updateCartCount();
    });
  </script>
</body>
</html>
